# AI Coding Guide for OneStream_Speed

- OneStream XF rule source of truth; files mirror objects stored in the platform. Import/export with the Code Utility for OneStream VS Code extension (XML packages), not a traditional build/deploy.
- Architecture: Workspaces → Maintenance Units → Assemblies. Most assemblies depend on the global utility assembly in Assemblies/OS Consultant Tools/App Objects (Globals)/GBL_UI_Assembly.
- Rule folders map to XML exports (e.g., Assemblies → ApplicationWorkspaces.xml, Finance → FinanceRules.xml, *EventHandler → ExtensibilityRules.xml). Keep files in the matching folder.
- Namespaces keep placeholders `__WsNamespacePrefix` and `__WsAssemblyName`; never replace them manually.
- Standard entrypoints: DashboardExtender/DashboardDataSet/DashboardStringFunction/Spreadsheet rules expose `Main(SessionInfo si, BRGlobals globals, object api, Args args)` with `switch` on FunctionType or FunctionName.
- Service factories wire assemblies to dashboards: see [Assemblies/OS Consultant Tools/Dynamic Dashboard Manager/DDM_UI_Assembly/Factory/DDM_Svc_Factory.cs](Assemblies/OS Consultant Tools/Dynamic Dashboard Manager/DDM_UI_Assembly/Factory/DDM_Svc_Factory.cs#L1-L38), [Assemblies/OS Consultant Tools/Finance Model Manager/FMM_UI_Assembly/Factory/FMM_Svc_Factory.cs](Assemblies/OS Consultant Tools/Finance Model Manager/FMM_UI_Assembly/Factory/FMM_Svc_Factory.cs#L1-L42), [Assemblies/OS Consultant Tools/Model Dimension Manager/MDM_Svc_Factory_Assembly/Factory/MDM_Svc_Factory.cs](Assemblies/OS Consultant Tools/Model Dimension Manager/MDM_Svc_Factory_Assembly/Factory/MDM_Svc_Factory.cs#L1-L34). Map `WsAssemblyServiceType.DynamicDashboards` to `*_DynDB_Svc` and `WsAssemblyServiceType.Dashboard` to `*_DB_Svc`.
- Error handling: wrap logic in try/catch and rethrow via `ErrorHandler.LogWrite(si, new XFException(si, ex))` or `new XFException(si, ex)` (mirrors factory implementations).
- BRApi patterns: `BRApi.Database.CreateApplicationDbConnInfo(si)` for DB access, `BRApi.FileSystem.*` for files, `BRApi.State.*` for session-scoped state, `BRApi.ErrorLog.LogMessage` for diagnostics. Avoid hardcoded connection strings and direct `File` IO in runtime rules.
- String comparisons favor OneStream helpers like `XFEqualsIgnoreCase` instead of manual casing.
- Custom table naming uses `<Prefix>_<Entity>` (DDM_, FMM_, etc.); SQL adapters live under `SQL Adapters/` per assembly (e.g., [Assemblies/OS Consultant Tools/App Objects (Globals)/GBL_UI_Assembly/SQL Adapters/SQL_GBL_Get_DataSets.cs](Assemblies/OS Consultant Tools/App Objects (Globals)/GBL_UI_Assembly/SQL Adapters/SQL_GBL_Get_DataSets.cs#L1-L37)).
- Shared utilities: global helper code in GBL_UI_Assembly; example bulk CSV importer at [Assemblies/OS Consultant Tools/App Objects (Globals)/GBL_UI_Assembly/GBL Support Classes/GBL_Import_CSV.cs](Assemblies/OS Consultant Tools/App Objects (Globals)/GBL_UI_Assembly/GBL Support Classes/GBL_Import_CSV.cs#L1-L130).
- Configuration for IntelliSense only: [Directory.Build.props](Directory.Build.props) points at OneStream DLLs, [OneStream_Speed.csproj](OneStream_Speed.csproj) holds references, [omnisharp.json](omnisharp.json) tunes the language server. No meaningful `dotnet build` output.
- Workflow: (1) Import objects from OneStream with the extension, (2) edit C# locally, (3) optional syntax check via IntelliSense, (4) export/generate XML, (5) import back into OneStream and test there.
- Testing/logging: execution only inside OneStream; use BRApi logging and the platform System Log. For timing, wrap with `System.Diagnostics.Stopwatch` and log elapsed ms.
- Conventions/pitfalls: keep placeholder namespaces; place new rules in the correct folder/type; prefer BRApi for DB/file/state; keep state session-scoped; avoid introducing non-ASCII unless existing.
- Useful abbreviations: SI=SessionInfo, BR=Business Rule, WS=Workspace, SQA=SQL Adapter, XFTV=XF Table View.

Keep instructions concise and codebase-specific; update this file when workflows or shared utilities change.
